# 📊 대용량 엑셀 안전 업로드 가이드

이 가이드는 **작업자, 팀, 현장, 회사** 데이터를 엑셀로 한 번에 안전하게 등록하는 방법을 설명합니다.
시스템은 **데이터베이스와 자동 비교**하여 중복을 방지하고, 오류가 있는 데이터는 건너뛰도록 설계되었습니다.

---

## 1. 공통 사용법 (4단계 마법사)

모든 업로드 기능은 동일한 4단계 과정을 거칩니다.

### 1단계: 파일 업로드
- **`.xlsx` 또는 `.xls` 형식**의 엑셀 파일만 지원합니다.
- 파일을 화면의 점선 영역으로 **드래그**하거나 버튼을 클릭하여 선택하세요.

### 2단계: 컬럼 연결 (매핑)
- 엑셀의 헤더(첫 번째 줄)를 시스템이 자동으로 인식합니다.
- **예:** 엑셀에 `성명`이라고 적혀있으면 시스템의 `이름` 필드와 자동으로 연결됩니다.
- 자동 연결이 안 된 경우, 드롭다운 메뉴에서 직접 선택해 주세요.
- **필수 항목(*표시)**은 반드시 연결되어야 다음으로 넘어갈 수 있습니다.

### 3단계: 데이터 확인 (프리뷰)
- 업로드 전, 데이터의 정합성을 검사합니다.
- **초록색 체크**: 정상 데이터 (등록 가능)
- **빨간색 느낌표**: 오류 데이터 (등록 불가 - 필수값 누락 등)
- **주황색 경고**: 중복 데이터 (이미 DB에 존재함 - 등록 시 건너뜀)
- *이 단계에서 눈으로 확인하고, 문제가 많으면 '이전'으로 돌아가 설정을 변경하세요.*

### 4단계: 일괄 저장
- **[업로드 시작]** 버튼을 누르면 저장이 시작됩니다.
- 50건씩 나누어 처리되므로 멈추지 말고 기다려주세요.
- 완료 후 성공/실패 건수가 표시됩니다.

---

## 2. 데이터별 상세 가이드

### 👷 작업자 (Worker) 등록
- **필수 컬럼**: `이름`
- **권장 컬럼**: `연락처`, `생년월일`, `주소`, `직종`, `소속팀`, `단가`
- **중복 처리**: `이름`과 `연락처`가 모두 일치하는 작업자가 이미 존재하면 **등록을 건너뜁니다(Skip)**.
- **팀 연결**: 엑셀의 `소속팀` 이름이 시스템에 존재하면 자동으로 연결됩니다. 없으면 '미배정' 처리됩니다.

### 🏗️ 팀 (Team) 등록
- **필수 컬럼**: `팀명`
- **권장 컬럼**: `팀장명`, `연락처`, `직종`
- **중복 처리**: 동일한 `팀명`이 존재하면 **등록 실패(Error)** 처리됩니다. 팀명은 고유해야 합니다.

### 🏢 현장 (Site) 등록
- **필수 컬럼**: `현장명`
- **권장 컬럼**: `주소`, `착공일`, `준공일`, `현장코드`
- **중복 처리**: 동일한 `현장명`이 존재하면 **등록 실패(Error)** 처리됩니다.

### 🤝 협력업체 (Company) 등록
- **필수 컬럼**: `회사명`
- **권장 컬럼**: `사업자번호`, `대표자`, `주소`
- **중복 처리**: 동일한 `회사명`이 있어도 **경고(Warning)**만 표시하고 등록은 가능합니다. (지사 등이 있을 수 있음)

---

## 3. 엑셀 파일 작성 팁 (오류 방지)
1. **첫 줄은 반드시 헤더(제목)**여야 합니다. (예: 이름, 전화번호, 주소...)
2. **빈 행**이 중간에 없도록 해주세요.
3. 날짜는 `2024-01-01` 또는 `2024.01.01` 형식을 권장합니다.
4. 숫자가 들어갈 곳(단가 등)에 `150,000`처럼 콤마가 있어도 괜찮지만, `15만원` 같은 글자는 피해주세요.

## 4. 자주 묻는 질문 (FAQ)
- **Q: 1만 건을 한 번에 올려도 되나요?**
  - A: 네, 시스템이 50개씩 끊어서 처리하므로 안전합니다. 다만 시간은 조금 걸릴 수 있습니다.
- **Q: 구글 시트는 안 되나요?**
  - A: 구글 시트에서 `파일 > 다운로드 > Microsoft Excel(.xlsx)`로 저장한 후 업로드하시면 됩니다.
